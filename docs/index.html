<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Crystal Docs 1.0.0">
<meta name="crystal_docs.project_version" content="master-dev">
<meta name="crystal_docs.project_name" content="binance">



<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

  <meta name="repository-name" content="binance">
  <title>binance master-dev</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          binance
        </a>
      </h1>

      <span class="project-version">
        master-dev
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class="parent " data-id="binance/Binance" data-name="binance">
      <a href="Binance.html">Binance</a>
      
        <ul>
  
  <li class=" " data-id="binance/Binance/Converters" data-name="binance::converters">
      <a href="Binance/Converters.html">Converters</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Endpoints" data-name="binance::endpoints">
      <a href="Binance/Endpoints.html">Endpoints</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Handler" data-name="binance::handler">
      <a href="Binance/Handler.html">Handler</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/HttpMethods" data-name="binance::httpmethods">
      <a href="Binance/HttpMethods.html">HttpMethods</a>
      
    </li>
  
  <li class="parent " data-id="binance/Binance/Listener" data-name="binance::listener">
      <a href="Binance/Listener.html">Listener</a>
      
        <ul>
  
  <li class=" " data-id="binance/Binance/Listener/ChannelClose" data-name="binance::listener::channelclose">
      <a href="Binance/Listener/ChannelClose.html">ChannelClose</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Listener/ChannelError" data-name="binance::listener::channelerror">
      <a href="Binance/Listener/ChannelError.html">ChannelError</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Listener/ChannelMessage" data-name="binance::listener::channelmessage">
      <a href="Binance/Listener/ChannelMessage.html">ChannelMessage</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="binance/Binance/Responses" data-name="binance::responses">
      <a href="Binance/Responses.html">Responses</a>
      
        <ul>
  
  <li class=" " data-id="binance/Binance/Responses/AccountResponse" data-name="binance::responses::accountresponse">
      <a href="Binance/Responses/AccountResponse.html">AccountResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/AggTradeEntry" data-name="binance::responses::aggtradeentry">
      <a href="Binance/Responses/AggTradeEntry.html">AggTradeEntry</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/AggTradesResponse" data-name="binance::responses::aggtradesresponse">
      <a href="Binance/Responses/AggTradesResponse.html">AggTradesResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/AvgPriceResponse" data-name="binance::responses::avgpriceresponse">
      <a href="Binance/Responses/AvgPriceResponse.html">AvgPriceResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/BalanceEntry" data-name="binance::responses::balanceentry">
      <a href="Binance/Responses/BalanceEntry.html">BalanceEntry</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/BookTickerEntry" data-name="binance::responses::booktickerentry">
      <a href="Binance/Responses/BookTickerEntry.html">BookTickerEntry</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/BookTickerResponse" data-name="binance::responses::booktickerresponse">
      <a href="Binance/Responses/BookTickerResponse.html">BookTickerResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/DepthEntry" data-name="binance::responses::depthentry">
      <a href="Binance/Responses/DepthEntry.html">DepthEntry</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/DepthResponse" data-name="binance::responses::depthresponse">
      <a href="Binance/Responses/DepthResponse.html">DepthResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/ExchangeFilter" data-name="binance::responses::exchangefilter">
      <a href="Binance/Responses/ExchangeFilter.html">ExchangeFilter</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/ExchangeInfoResponse" data-name="binance::responses::exchangeinforesponse">
      <a href="Binance/Responses/ExchangeInfoResponse.html">ExchangeInfoResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/ExchangeSymbol" data-name="binance::responses::exchangesymbol">
      <a href="Binance/Responses/ExchangeSymbol.html">ExchangeSymbol</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/FilterException" data-name="binance::responses::filterexception">
      <a href="Binance/Responses/FilterException.html">FilterException</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/IcebergPartsFilter" data-name="binance::responses::icebergpartsfilter">
      <a href="Binance/Responses/IcebergPartsFilter.html">IcebergPartsFilter</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/Kline" data-name="binance::responses::kline">
      <a href="Binance/Responses/Kline.html">Kline</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/KlinesResponse" data-name="binance::responses::klinesresponse">
      <a href="Binance/Responses/KlinesResponse.html">KlinesResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/LotSizeFilter" data-name="binance::responses::lotsizefilter">
      <a href="Binance/Responses/LotSizeFilter.html">LotSizeFilter</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/MarketLotSizeFilter" data-name="binance::responses::marketlotsizefilter">
      <a href="Binance/Responses/MarketLotSizeFilter.html">MarketLotSizeFilter</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/MaxNumAlgoOrdersFilter" data-name="binance::responses::maxnumalgoordersfilter">
      <a href="Binance/Responses/MaxNumAlgoOrdersFilter.html">MaxNumAlgoOrdersFilter</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/MinNotionalFilter" data-name="binance::responses::minnotionalfilter">
      <a href="Binance/Responses/MinNotionalFilter.html">MinNotionalFilter</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/MyTradeEntry" data-name="binance::responses::mytradeentry">
      <a href="Binance/Responses/MyTradeEntry.html">MyTradeEntry</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/MyTradesResponse" data-name="binance::responses::mytradesresponse">
      <a href="Binance/Responses/MyTradesResponse.html">MyTradesResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/Order" data-name="binance::responses::order">
      <a href="Binance/Responses/Order.html">Order</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/OrderFill" data-name="binance::responses::orderfill">
      <a href="Binance/Responses/OrderFill.html">OrderFill</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/OrderResponse" data-name="binance::responses::orderresponse">
      <a href="Binance/Responses/OrderResponse.html">OrderResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/PercentPriceFilter" data-name="binance::responses::percentpricefilter">
      <a href="Binance/Responses/PercentPriceFilter.html">PercentPriceFilter</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/PingResponse" data-name="binance::responses::pingresponse">
      <a href="Binance/Responses/PingResponse.html">PingResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/PriceEntry" data-name="binance::responses::priceentry">
      <a href="Binance/Responses/PriceEntry.html">PriceEntry</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/PriceFilter" data-name="binance::responses::pricefilter">
      <a href="Binance/Responses/PriceFilter.html">PriceFilter</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/PriceResponse" data-name="binance::responses::priceresponse">
      <a href="Binance/Responses/PriceResponse.html">PriceResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/RateLimit" data-name="binance::responses::ratelimit">
      <a href="Binance/Responses/RateLimit.html">RateLimit</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/ServerResponse" data-name="binance::responses::serverresponse">
      <a href="Binance/Responses/ServerResponse.html">ServerResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/TimeResponse" data-name="binance::responses::timeresponse">
      <a href="Binance/Responses/TimeResponse.html">TimeResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/TradeEntry" data-name="binance::responses::tradeentry">
      <a href="Binance/Responses/TradeEntry.html">TradeEntry</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/TradesResponse" data-name="binance::responses::tradesresponse">
      <a href="Binance/Responses/TradesResponse.html">TradesResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/TwentyFourHourEntry" data-name="binance::responses::twentyfourhourentry">
      <a href="Binance/Responses/TwentyFourHourEntry.html">TwentyFourHourEntry</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/TwentyFourHourResponse" data-name="binance::responses::twentyfourhourresponse">
      <a href="Binance/Responses/TwentyFourHourResponse.html">TwentyFourHourResponse</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/UserDataStreamResponse" data-name="binance::responses::userdatastreamresponse">
      <a href="Binance/Responses/UserDataStreamResponse.html">UserDataStreamResponse</a>
      
    </li>
  
  <li class="parent " data-id="binance/Binance/Responses/Websocket" data-name="binance::responses::websocket">
      <a href="Binance/Responses/Websocket.html">Websocket</a>
      
        <ul>
  
  <li class=" " data-id="binance/Binance/Responses/Websocket/AggregateTrade" data-name="binance::responses::websocket::aggregatetrade">
      <a href="Binance/Responses/Websocket/AggregateTrade.html">AggregateTrade</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/Websocket/BookTicker" data-name="binance::responses::websocket::bookticker">
      <a href="Binance/Responses/Websocket/BookTicker.html">BookTicker</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/Websocket/Candle" data-name="binance::responses::websocket::candle">
      <a href="Binance/Responses/Websocket/Candle.html">Candle</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/Websocket/Data" data-name="binance::responses::websocket::data">
      <a href="Binance/Responses/Websocket/Data.html">Data</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/Websocket/Depth" data-name="binance::responses::websocket::depth">
      <a href="Binance/Responses/Websocket/Depth.html">Depth</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/Websocket/Kline" data-name="binance::responses::websocket::kline">
      <a href="Binance/Responses/Websocket/Kline.html">Kline</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/Websocket/MiniTicker" data-name="binance::responses::websocket::miniticker">
      <a href="Binance/Responses/Websocket/MiniTicker.html">MiniTicker</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/Websocket/PartialDepth" data-name="binance::responses::websocket::partialdepth">
      <a href="Binance/Responses/Websocket/PartialDepth.html">PartialDepth</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/Websocket/Stream" data-name="binance::responses::websocket::stream">
      <a href="Binance/Responses/Websocket/Stream.html">Stream</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/Websocket/Ticker" data-name="binance::responses::websocket::ticker">
      <a href="Binance/Responses/Websocket/Ticker.html">Ticker</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/Websocket/Trade" data-name="binance::responses::websocket::trade">
      <a href="Binance/Responses/Websocket/Trade.html">Trade</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Responses/Websocket/TradeBase" data-name="binance::responses::websocket::tradebase">
      <a href="Binance/Responses/Websocket/TradeBase.html">TradeBase</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="binance/Binance/REST" data-name="binance::rest">
      <a href="Binance/REST.html">REST</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Service" data-name="binance::service">
      <a href="Binance/Service.html">Service</a>
      
    </li>
  
  <li class=" " data-id="binance/Binance/Websocket" data-name="binance::websocket">
      <a href="Binance/Websocket.html">Websocket</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1><a id="binance" class="anchor" href="#binance">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Binance</h1>

<p>This is an unofficial Crystal wrapper for the Binance exchange REST and WebSocket APIs.</p>

<p>Requires Crystal >= 0.35.1</p>

<ul><li><a href="https://mwlang.github.io/binance/">Source Documentation</a></li><li><a href="https://github.com/mwlang/binance/tree/master/examples">Examples</a></li><li><a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md">Official Binance API Documentation</a></li></ul>

<h2><a id="tldr" class="anchor" href="#tldr">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>TL;DR</h2>

<p>Run this:</p>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;binance&quot;</span>

api_key <span class="o">=</span> <span class="s">&quot;vmPUZE6mv9SD5VNHk4HlWFsOr6aKE2zvsw0MuIgwCIPy6utIco14y7Ju91duEh8A&quot;</span>
api_secret <span class="o">=</span> <span class="s">&quot;NhqPtmdSJYdKjVHjA7PZj4Mge3R5YNiP1e3UZjInClVN65XAbvqqM6A7H5fATj0j&quot;</span>

signed_client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">REST</span>.<span class="k">new</span>(api_key: api_key, secret_key: api_secret)

symbol <span class="o">=</span> <span class="s">&quot;BNBUSDC&quot;</span>
current_price <span class="o">=</span> signed_client.price(symbol).tickers[<span class="n">0</span>].price

puts <span class="s">&quot;current price for </span><span class="i">#{</span>symbol<span class="i">}</span><span class="s"> is %0.6f&quot;</span> <span class="o">%</span> current_price

puts <span class="s">&quot;placing limit SELL order...&quot;</span>

response <span class="o">=</span> signed_client.new_order(
  symbol: symbol,
  side: <span class="s">&quot;SELL&quot;</span>,
  order_type: <span class="s">&quot;LIMIT&quot;</span>,
  time_in_force: <span class="s">&quot;GTC&quot;</span>,
  quantity: <span class="n">1.0</span>,
  price: (current_price <span class="o">*</span> <span class="n">1.1</span>).round(<span class="n">4</span>)
)

puts <span class="s">&quot;Order placed successfully? </span><span class="i">#{</span>response.success<span class="i">}</span><span class="s">&quot;</span>

<span class="k">if</span> response.success
  order <span class="o">=</span> response.orders[<span class="n">0</span>]
  puts <span class="s">&quot;Order </span><span class="i">#{</span>order.order_id<span class="i">}</span><span class="s"> placed.  Status: </span><span class="i">#{</span>order.status<span class="i">}</span><span class="s">&quot;</span>
  puts <span class="s">&quot;canceling the order...&quot;</span>
  response <span class="o">=</span> signed_client.cancel_order(
    symbol: symbol,
    order_id: order.order_id
  )
  <span class="k">if</span> response.success
    puts <span class="s">&quot;order cancelled successfully&quot;</span>
  <span class="k">else</span>
    puts <span class="s">&quot;order was NOT canceled!&quot;</span>
    puts <span class="s">&quot;</span><span class="i">#{</span>response.error_code<span class="i">}</span><span class="s">: </span><span class="i">#{</span>response.error_message<span class="i">}</span><span class="s">&quot;</span>
  <span class="k">end</span>
<span class="k">else</span>
  puts <span class="s">&quot;</span><span class="i">#{</span>response.error_code<span class="i">}</span><span class="s">: </span><span class="i">#{</span>response.error_message<span class="i">}</span><span class="s">&quot;</span>
<span class="k">end</span>

puts <span class="s">&quot;That&#39;s all folks!&quot;</span></code></pre>

<p>Get This:</p>

<pre><code class="language-text">>> crystal run examples/orders.cr
current price for BNBUSDC is 32.633600
placing limit SELL order...
Order placed successfully? true
Order 20556246 placed.  Status: NEW
canceling the order...
order cancelled successfully
That's all folks!</code></pre>

<h2><a id="features" class="anchor" href="#features">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Features</h2>

<p>Current:</p>

<ul><li>Basic implementation of REST API</li><li>Both binance.com and binance.us supported</li><li>Easy to use authentication</li><li>Methods return <code><a href="Binance/Responses/ServerResponse.html">Binance::Responses::ServerResponse</a></code> objects with JSON already deserialized</li><li>No need to generate signatures</li></ul></ul>

<ul><li>Basic Websocket API for Listening</li><li>Some streams mapped for JSON decoding (all streams currently accessible through JSON unmapped hash)</li></ul></ul>

<ul><li>Websocket API</li><li>Most streams deserialized (see TODO list below)</li><li>Single and multiple streams supported via <code>Handler</code> class</li><li>WebSocket Live subscribe/unsubscribe and sending commands</li></ul></ul>

<h2><a id="rest-endpoints" class="anchor" href="#rest-endpoints">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>REST Endpoints</h2>

<p>By default, the client is connected to <code>binance.com</code>, but <code>binance.us</code> is also fully supported.  When instantiating the client, the third parameter sets the service endpoint and is one of:</p>

<ul><li><code><a href="Binance/Service.html#Com">Binance::Service::Com</a></code></li><li><code><a href="Binance/Service.html#Us">Binance::Service::Us</a></code></li></ul></ul>

<pre><code class="language-crystal">puts <span class="s">&quot;binance.com...&quot;</span>
client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">REST</span>.<span class="k">new</span>(<span class="s">&quot;&quot;</span>, <span class="s">&quot;&quot;</span>, <span class="t">Binance</span><span class="t">::</span><span class="t">Service</span><span class="t">::</span><span class="t">Com</span>)

puts client.time.body
puts client.time.server_time.inspect
puts client.time.used_weight.inspect

puts <span class="s">&quot;binance.us...&quot;</span>
client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">REST</span>.<span class="k">new</span>(<span class="s">&quot;&quot;</span>, <span class="s">&quot;&quot;</span>, <span class="t">Binance</span><span class="t">::</span><span class="t">Service</span><span class="t">::</span><span class="t">Us</span>)

puts client.time.body
puts client.time.server_time.inspect
puts client.time.used_weight.inspect</code></pre>

<h3><a id="public-none" class="anchor" href="#public-none">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>PUBLIC (NONE)</h3>

<ul><li>[x] <code>ping</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#test-connectivity">ping</a> Test connectivity to the Rest API.</li><li>[x] <code>time</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#check-server-time">time</a> Test connectivity to the Rest API and get the current server time.</li><li>[x] <code>exchange_info</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#exchange-information">exchangeInfo</a> Current exchange trading rules and symbol information</li><li>[x] <code>depth</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#order-book">depth (order book)</a> Get Order book depth info.</li><li>[x] <code>trades</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#recent-trades-list">trades</a> Get recent trades (up to last 500).</li><li>[x] <code>agg_trades</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#compressedaggregate-trades-list">aggTrades</a> Get compressed, aggregate trades.</li><li>[x] <code>klines</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#klinecandlestick-data">klines</a> Kline/candlestick bars for a symbol. Klines are uniquely identified by their open time.</li><li>[x] <code>avg_price</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#current-average-price">avgPrice</a> Current average price for a symbol.</li><li>[x] <code>twenty_four_hour</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#24hr-ticker-price-change-statistics">ticker/24hr</a> 24 hour rolling window price change statistics.</li><li>[x] <code>price</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#symbol-price-ticker">ticker/price</a> Latest price for a symbol or symbols.</li><li>[x] <code>book_ticker</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#symbol-order-book-ticker">ticker/bookTicker</a> Best price/qty on the order book for a symbol or symbols.</li></ul>

<h3><a id="market-data-api-key-required" class="anchor" href="#market-data-api-key-required">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>MARKET_DATA (API_KEY required)</h3>

<ul><li>[x] <code>historical_trades</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#old-trade-lookup-market_data">historicalTrades</a> Get older trades.</li></ul>

<h3><a id="user-data-stream-api-key-required" class="anchor" href="#user-data-stream-api-key-required">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>USER_DATA_STREAM (API_KEY required)</h3>

<ul><li>[x] <code>user_data_stream</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#start-user-data-stream-user_stream">userDataStream</a> Start a new user data stream.</li></ul>

<h3><a id="signed-api-key-and-signed-with-secret-key-required" class="anchor" href="#signed-api-key-and-signed-with-secret-key-required">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>SIGNED (API_KEY and signed with SECRET_KEY required)</h3>

<ul><li>[x] <code>account</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#account-information-user_data">account</a> Get current account information.</li><li>[x] <code>get_order</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#query-order-user_data">GET order (query)</a> Check an order's status.</li><li>[x] <code>open_orders</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#current-open-orders-user_data">GET openOrders</a> Get all open orders on a symbol.</li><li>[x] <code>all_orders</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#all-orders-user_data">GET allOrders</a> Get all account orders; active, canceled, or filled.</li><li>[x] <code>new_order</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#new-order--trade">POST order (new order)</a> Send in a new order.</li><li>[x] <code>new_test_order</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#test-new-order-trade">POST order/test (test new order)</a> Creates and validates a new order but does not send it into the matching engine.</li><li>[x] <code>cancel_order</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#cancel-order-trade">DELETE order (cancel order)</a> Cancel an active order.</li><li>[x] <code>my_trades</code> <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#account-trade-list-user_data">myTrades</a> Get trades for a specific account and symbol.</li></ul>

<h2><a id="websocket-streams" class="anchor" href="#websocket-streams">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Websocket Streams</h2>

<ul><li>[x] <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md#aggregate-trade-streams">Aggregate Trade Streams</a></li><li>[x] <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md#trade-streams">Trade Streams</a></li><li>[x] <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md#klinecandlestick-streams">Kline/Candlestick Streams</a></li><li>[x] <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md#individual-symbol-mini-ticker-stream">Individual Symbol Mini Ticker Stream</a></li><li>[x] <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md#all-market-mini-tickers-stream">All Market Mini Tickers Stream</a></li><li>[x] <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md#individual-symbol-ticker-streams">Individual Symbol Ticker Streams</a></li><li>[x] <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md#all-market-tickers-stream">All Market Tickers Stream</a></li><li>[x] <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md#individual-symbol-book-ticker-streams">Individual Symbol Book Ticker Streams</a></li><li>[x] <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md#all-book-tickers-stream">All Book Tickers Stream</a></li><li>[x] <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md#partial-book-depth-streams">Partial Book Depth Streams</a></li><li>[x] <a href="https://github.com/binance/binance-spot-api-docs/blob/master/web-socket-streams.md#diff-depth-stream">Diff Depth Stream</a></li></ul>

<h2><a id="installation" class="anchor" href="#installation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Installation</h2>

<ol><li>Add the dependency to your <code>shard.yml</code>:</li></ol>

<pre><code class="language-yaml">dependencies:
  binance:
    github: mwlang/binance</code></pre>

<ol><li>Run <code>shards install</code></li></ol>

<h2><a id="getting-started" class="anchor" href="#getting-started">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Getting Started</h2>

<h3><a id="rest-client" class="anchor" href="#rest-client">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>REST client</h3>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;binance&quot;</span>

client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">REST</span>.<span class="k">new</span>

puts client.ping.pong.inspect => <span class="n">true</span>

client.klines(symbol: <span class="s">&quot;BNBBTC&quot;</span>, interval: <span class="s">&quot;5m&quot;</span>, limit: <span class="n">5</span>).klines.each <span class="k">do</span> <span class="o">|</span>kline<span class="o">|</span>
  puts <span class="s">&quot;</span><span class="i">#{</span>kline.open_time<span class="i">}</span><span class="s"> O: </span><span class="i">#{</span><span class="s">&quot;%0.6f&quot;</span> <span class="o">%</span> kline.open_price<span class="i">}</span><span class="s"> C: </span><span class="i">#{</span><span class="s">&quot;%0.6f&quot;</span> <span class="o">%</span> kline.close_price<span class="i">}</span><span class="s">&quot;</span>
<span class="k">end</span>

<span class="c"># =&gt;</span>
<span class="c"># 2019-07-02 15:35:00 UTC O: 0.003031 C: 0.003035</span>
<span class="c"># 2019-07-02 15:40:00 UTC O: 0.003035 C: 0.003023</span>
<span class="c"># 2019-07-02 15:45:00 UTC O: 0.003023 C: 0.003031</span>
<span class="c"># 2019-07-02 15:50:00 UTC O: 0.003033 C: 0.003032</span>
<span class="c"># 2019-07-02 15:55:00 UTC O: 0.003032 C: 0.003010</span>

api_key <span class="o">=</span> <span class="s">&quot;vmPUZE6mv9SD5VNHk4HlWFsOr6aKE2zvsw0MuIgwCIPy6utIco14y7Ju91duEh8A&quot;</span>
api_secret <span class="o">=</span> <span class="s">&quot;NhqPtmdSJYdKjVHjA7PZj4Mge3R5YNiP1e3UZjInClVN65XAbvqqM6A7H5fATj0j&quot;</span>

signed_client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">REST</span>.<span class="k">new</span> api_key: api_key, secret_key: api_secret
signed_client.historical_trades(<span class="s">&quot;BTCUSDC&quot;</span>, <span class="n">5</span>).trades.each <span class="k">do</span> <span class="o">|</span>trade<span class="o">|</span>
  puts <span class="s">&quot;</span><span class="i">#{</span>trade.time<span class="i">}</span><span class="s"> </span><span class="i">#{</span><span class="s">&quot;%0.6f&quot;</span> <span class="o">%</span> trade.price<span class="i">}</span><span class="s"> </span><span class="i">#{</span><span class="s">&quot;%0.6f&quot;</span> <span class="o">%</span> trade.quantity<span class="i">}</span><span class="s">&quot;</span>
<span class="k">end</span>

<span class="c"># =&gt;</span>
<span class="c"># 2019-07-02 16:08:07 UTC 10465.560000 0.001689</span>
<span class="c"># 2019-07-02 16:08:09 UTC 10465.650000 1.000000</span>
<span class="c"># 2019-07-02 16:08:09 UTC 10465.650000 0.034570</span>
<span class="c"># 2019-07-02 16:08:09 UTC 10465.650000 0.017813</span>
<span class="c"># 2019-07-02 16:08:09 UTC 10471.390000 0.049130</span></code></pre>

<p>Initializing the REST client:</p>

<p>If you only plan on touching public API endpoints, you can forgo any arguments.
Any of the public (NONE) api endpoints will work without an API key.</p>

<pre><code class="language-crystal">client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">REST</span>.<span class="k">new</span></code></pre>

<p>Otherwise provide an api_key and secret_key as keyword arguments</p>

<pre><code class="language-crystal">client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">REST</span>.<span class="k">new</span> api_key: <span class="s">&quot;x&quot;</span>, secret_key: <span class="s">&quot;y&quot;</span></code></pre>

<h3><a id="websocket-client" class="anchor" href="#websocket-client">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Websocket client</h3>

<p>The basic Websocket API is implemented.  Advanced live subscribe/unsubscribe is not.</p>

<p>Using a websocket is composed of two parts:</p>

<ol><li>The websocket listener/client</li><li>The update handler for the incoming data stream(s)</li></ol>

<p>The handler should inherit from <code><a href="Binance/Handler.html">Binance::Handler</a></code></p>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;binance&quot;</span>

<span class="c"># Each market will instantiate it&#39;s own TickerHandler</span>
<span class="k">class</span> <span class="t">TickerHandler</span> <span class="o">&lt;</span> <span class="t">Binance</span><span class="t">::</span><span class="t">Handler</span>

  <span class="c"># implement an update() method in your handler to process</span>
  <span class="c"># what was sent over the websocket stream</span>
  <span class="k">def</span> <span class="m">update</span>(stream)
    ticker <span class="o">=</span> stream.ticker
    puts [
      ticker.symbol,
      <span class="s">&quot;messages: </span><span class="i">#{</span>messages<span class="i">}</span><span class="s">&quot;</span>,
      <span class="s">&quot;bid: %0.6f&quot;</span> <span class="o">%</span> ticker.bid_price,
      <span class="s">&quot;ask: %0.6f&quot;</span> <span class="o">%</span> ticker.ask_price,
      <span class="s">&quot;change: %0.3f&quot;</span> <span class="o">%</span> ticker.price_change_percent,
      <span class="s">&quot;high: %0.6f&quot;</span> <span class="o">%</span> ticker.high_price,
      <span class="s">&quot;low: %0.6f&quot;</span> <span class="o">%</span> ticker.low_price,
    ].join(<span class="s">&quot; &quot;</span>)
  <span class="k">end</span>
<span class="k">end</span>

puts <span class="s">&quot;starting ticker listener&quot;</span>

<span class="c"># Instantiating a Listener like this enables you to open any named stream</span>
<span class="c"># even if this library hasn&#39;t implemented the convenience methods or</span>
<span class="c"># the JSON serializers for that stream, yet.</span>
<span class="c"># If a serializer isn&#39;t available, then inspect the `stream.data#unmapped`</span>
<span class="c"># property to extract the desired data from the stream message.</span>
listener <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">Listener</span>.<span class="k">new</span> [<span class="s">&quot;BTCUSDT&quot;</span>, <span class="s">&quot;BNBBTC&quot;</span>], <span class="s">&quot;ticker&quot;</span>, <span class="t">TickerHandler</span>

<span class="c"># loop forever -- CTRL-C to break out in terminal</span>
loop <span class="k">do</span>
  <span class="k">if</span> reason <span class="o">=</span> listener.run
    <span class="k">break</span> <span class="k">if</span> reason[<span class="n">:status</span>] <span class="o">==</span> <span class="s">&quot;UNHANDLED&quot;</span>
    sleep(<span class="n">30</span>.seconds) <span class="k">if</span> reason[<span class="n">:status</span>] <span class="o">==</span> <span class="s">&quot;ERROR&quot;</span>
    sleep(<span class="n">5</span>.seconds) <span class="k">if</span> reason[<span class="n">:status</span>] <span class="o">==</span> <span class="s">&quot;CLOSED&quot;</span>
  <span class="k">else</span>
    puts <span class="s">&quot;No reason returned from listener&quot;</span>
  <span class="k">end</span>
<span class="k">end</span>

puts <span class="s">&quot;ticker listener stopped...&quot;</span></code></pre>

<p>Listeners may also be instantiated through the <code>Websocket</code> client class like this:</p>

<pre><code class="language-crystal"><span class="c">#...</span>
client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">Websocket</span>.<span class="k">new</span>
listener <span class="o">=</span> client.depth <span class="t">SYMBOLS</span>, <span class="t">OrderBookHandler</span></code></pre>

<p>Note:  Not all streams have convenience classes or serializers.  Pull requests greatly appreciated!
The following streams have convenience classes:</p>

<ul><li><code>combo</code> -- pass an array of symbols and array of streams (more info below)</li><li><code>aggregate_trade</code> -- opens <code>aggTrade</code> stream on given array of symbols</li><li><code>trade</code> -- opens <code>trade</code> stream on given array of symbols</li><li><code>ticker</code> -- opens <code>ticker</code> stream</li><li><code>book_ticker</code> -- opens <code>bookTicker</code> stream</li><li><code>depth</code> -- opens <code>depth</code> stream (pass also speed param "100ms" for faster updates)</li></ul>

<p>If you want to handle the scenario where the Binance server sometimes stops sending
data to the client, but doesn't actually close the stream, then invoke with a Timeout span greater than zero:</p>

<pre><code class="language-crystal"><span class="c"># ...</span>
client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">Websocket</span>.<span class="k">new</span>
listener <span class="o">=</span> client.depth <span class="t">SYMBOLS</span>, <span class="t">OrderBookHandler</span>, <span class="n">30</span>.seconds
<span class="c"># ...</span></code></pre>

<p>This will cause the listener to close the websocket stream after 30 seconds of no updates, thus breaking the <code>#run</code>
blocking call.</p>

<p>To connect to <code>binance.us</code> websocket, then specify the <code>service</code> when intializing:</p>

<pre><code class="language-crystal"><span class="c"># ...</span>
client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">Websocket</span>.<span class="k">new</span>(<span class="s">&quot;&quot;</span>, <span class="s">&quot;&quot;</span>, <span class="t">Binance</span><span class="t">::</span><span class="t">Service</span><span class="t">::</span>us)
listener <span class="o">=</span> client.depth <span class="t">SYMBOLS</span>, <span class="t">OrderBookHandler</span>, <span class="n">30</span>.seconds
<span class="c"># ...</span></code></pre>

<p>The following streams are for all symbols so do not take a list of symbols like the usual streams.</p>

<ul><li><code>all_book_tickers</code> - Opens the book ticker stream for all symbols</li><li><code>all_tickers</code> - Opens the ticker stream for all symbols</li><li><code>all_mini_tickers</code> - Opens the ticker stream for all mini_tickers</li></ul>

<pre><code class="language-crystal"><span class="c"># ...</span>
client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">Websocket</span>.<span class="k">new</span>(<span class="s">&quot;&quot;</span>, <span class="s">&quot;&quot;</span>, <span class="t">Binance</span><span class="t">::</span><span class="t">Service</span><span class="t">::</span><span class="t">Us</span>)
listener <span class="o">=</span> client.all_book_tickers(<span class="t">BookTickerHandler</span>, <span class="n">30</span>.seconds)
<span class="c"># ...</span></code></pre>

<h4><a id="one-handler-multiple-streams" class="anchor" href="#one-handler-multiple-streams">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>One Handler, Multiple Streams</h4>

<p>The above examples are passing an uninstantiated <code><a href="Binance/Handler.html">Binance::Handler</a>+</code> class.  When the class is passed, a handler is
instantiated for each symbol and stream.  Another way is to instantiate the <code><a href="Binance/Handler.html">Binance::Handler</a>+</code> class and pass that and
this will cause the websocket to wire up such that the one handler services all the streams.  For example:</p>

<pre><code class="language-crystal">handler <span class="o">=</span> <span class="t">ComboHandler</span>.<span class="k">new</span>
client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">Websocket</span>.<span class="k">new</span>
listener <span class="o">=</span> client.combo [<span class="s">&quot;BTCUSDT&quot;</span>, <span class="s">&quot;BNBBTC&quot;</span>], <span class="s">&quot;ticker,bookTicker,depth&quot;</span>, handler, <span class="n">30</span>.seconds</code></pre>

<p>Sets up the websocket streaming such that ticker, book_ticker, and depth streams are subscribed for BTCUSDT and BNBBTC
markets and all streamed messages are sent to the one <code>handler</code>.</p>

<h3><a id="exchange-filters" class="anchor" href="#exchange-filters">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Exchange Filters</h3>

<p>Binance provides a flexible system of setting filters on each market pair (a.k.a. <code>ExchangeSymbol</code>).  For example, <code>PRICE_FILTER</code>
is available on any given <code>ExchangeSymbol</code> as the <code>price_filter</code> property.  Most of the filters implement both a <code>validate</code> and
<code>valid?(value : Float64)</code> method to make it easy to validate if your intended price or quantity, etc. will pass the
filters on Binance's server when submitted.</p>

<p><span class="flag purple">NOTE</span>  The filters' validations are not invoked in the process of calling the new order API's
and is your responsibility to utilize them as you see fit.</p>

<p>Example:</p>

<pre><code class="language-crystal">client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">REST</span>.<span class="k">new</span>(api_key, api_secret)
assets <span class="o">=</span> client.exchange_info.symbols
symbol <span class="o">=</span> assets[<span class="n">0</span>] <span class="c"># =&gt; Binance::Response::ExchangeSymbol for ETHBTC (coincidentally!)</span>

<span class="c"># The price_filter&#39;s properties are delegated, so are accessible directly on the symbol.</span>
puts symbol.tick_size <span class="c"># =&gt; 0.000001</span>
puts symbol.min_price <span class="c"># =&gt; 0.000001</span>
puts symbol.max_price <span class="c"># =&gt; 100000.0</span>
puts symbol.price_filter.valid?(<span class="n">0.0</span>) <span class="c"># =&gt; false</span>
pp symbol.price_filter.validate(<span class="n">0.0</span>) <span class="c"># =&gt; [&quot;0.0 is below min_price of 0.000001&quot;]</span>
pp symbol.price_filter.validate(<span class="n">0.0000011</span>) <span class="c"># =&gt; [&quot;0.0000011  is an invalid tick_size 0.000001&quot;]</span></code></pre>

<ul><li><code>#validate</code> returns array of error messages which may be empty.</li><li><code>#valid?</code> returns <code>true</code> or <code>false</code></li><li>for filters with <code>#tick_size</code> and <code>#step_size</code>, <code>#decimals</code> returns number of decimals to round a value to.</li></ul>

<h4><a id="anatomy-of-a-binanceresponsesserver-response" class="anchor" href="#anatomy-of-a-binanceresponsesserver-response">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Anatomy of a <code><a href="Binance/Responses/ServerResponse.html">Binance::Responses::ServerResponse</a></code></h4>

<p>Every API endpoint call results in a ServerResponse that deserializes the JSON data retrieved from the server.</p>

<p>A ServerResponse is either a successful call and loaded with data or in an error state.  Exceptions
from connection fails or the server returning error codes are captured.  It is up to you to check
for errors before attempting to access the properties of the ServerResponses</p>

<p>When accessing the properties of the JSON responses, Generally speaking:</p>

<ul><li>camel-cased JSON keys become downcased and underscored.</li><li>abbreviations are spelled out (e.g. qty => quantity).</li><li>If an API can return one or more, it's always an Array property on the <code>ServerResponse</code> object.</li></ul></ul>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;binance&quot;</span>

client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">REST</span>.<span class="k">new</span>

puts client.ping.inspect

<span class="c"># =&gt; #&lt;Binance::Responses::PingResponse:0x10d40c280</span>
<span class="c">#   @success=true,</span>
<span class="c">#   @error_code=nil,</span>
<span class="c">#   @error_message=nil,</span>
<span class="c">#   @response=#&lt;Cossack::Response:0x10d3fe5a0 @status=200,</span>
<span class="c">#     @headers=HTTP::Headers{</span>
<span class="c">#       &quot;Content-Type&quot; =&gt; &quot;application/json;charset=utf-8&quot;,</span>
<span class="c">#       &quot;Transfer-Encoding&quot; =&gt; &quot;chunked&quot;,</span>
<span class="c">#       &quot;Connection&quot; =&gt; &quot;keep-alive&quot;,</span>
<span class="c">#       &quot;Date&quot; =&gt; &quot;Tue, 02 Jul 2019 15:26:47 GMT&quot;,</span>
<span class="c">#       &quot;Server&quot; =&gt; &quot;nginx&quot;,</span>
<span class="c">#       &quot;Vary&quot; =&gt; &quot;Accept-Encoding&quot;,</span>
<span class="c">#       &quot;X-MBX-USED-WEIGHT&quot; =&gt; &quot;3&quot;,</span>
<span class="c">#       &quot;Strict-Transport-Security&quot; =&gt;</span>
<span class="c">#       &quot;max-age=31536000; includeSubdomains&quot;,</span>
<span class="c">#       &quot;X-Frame-Options&quot; =&gt; &quot;SAMEORIGIN&quot;,</span>
<span class="c">#       &quot;X-Xss-Protection&quot; =&gt; &quot;1; mode=block&quot;,</span>
<span class="c">#       &quot;X-Content-Type-Options&quot; =&gt; &quot;nosniff&quot;,</span>
<span class="c">#       &quot;Content-Security-Policy&quot; =&gt; &quot;default-src &#39;self&#39;&quot;,</span>
<span class="c">#       &quot;X-Content-Security-Policy&quot; =&gt; &quot;default-src &#39;self&#39;&quot;,</span>
<span class="c">#       &quot;X-WebKit-CSP&quot; =&gt; &quot;default-src &#39;self&#39;&quot;,</span>
<span class="c">#       &quot;Cache-Control&quot; =&gt; &quot;no-cache, no-store, must-revalidate&quot;,</span>
<span class="c">#       &quot;Pragma&quot; =&gt; &quot;no-cache&quot;,</span>
<span class="c">#       &quot;Expires&quot; =&gt; &quot;0&quot;,</span>
<span class="c">#       &quot;Content-Encoding&quot; =&gt; &quot;gzip&quot;,</span>
<span class="c">#       &quot;X-Cache&quot; =&gt; &quot;Miss from cloudfront&quot;,</span>
<span class="c">#       &quot;Via&quot; =&gt; &quot;1.1 f5d17f65245ed818b0a01bb46646051c.cloudfront.net (CloudFront)&quot;,</span>
<span class="c">#       &quot;X-Amz-Cf-Pop&quot; =&gt; &quot;ATL50-C1&quot;,</span>
<span class="c">#       &quot;X-Amz-Cf-Id&quot; =&gt; &quot;-lcrDlHfRIAYp7ULZLmEqNzDMCU8U4q5LnS60csCxtYe-SRY3qqqTQ==&quot;</span>
<span class="c">#       },</span>
<span class="c">#     @body=&quot;{}&quot;&gt;,</span>
<span class="c">#   @exception=nil&gt;</span></code></pre>

<p>The raw JSON returned is accessible via the #body property of the <code>ServerResponse</code></p>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;binance&quot;</span>

client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">REST</span>.<span class="k">new</span>

puts client.time.body
<span class="c"># =&gt; {&quot;serverTime&quot;:1562224025253}</span>

puts client.time.server_time.inspect
<span class="c"># =&gt; 2019-07-04 07:07:06.009000000 UTC</span></code></pre>

<p>The weight used on the API call is returned in the response headers as "X-MBX-USED-WEIGHT".
This is conveniently accessible via <code>#used_weight</code> property of the <code>ServerResponse</code></p>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;binance&quot;</span>

client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">REST</span>.<span class="k">new</span>

response <span class="o">=</span> client.twenty_four_hour
puts <span class="s">&quot;WEIGHT %i&quot;</span> <span class="o">%</span> response.used_weight
puts <span class="s">&quot;TICKERS %i&quot;</span> <span class="o">%</span> response.tickers.size

response.tickers[<span class="n">0</span>,<span class="n">5</span>].each <span class="k">do</span> <span class="o">|</span>ticker<span class="o">|</span>
  puts [
      ticker.symbol,
      <span class="s">&quot;bid: %0.6f&quot;</span> <span class="o">%</span> ticker.bid_price,
      <span class="s">&quot;ask: %0.6f&quot;</span> <span class="o">%</span> ticker.ask_price,
      <span class="s">&quot;change: %0.3f&quot;</span> <span class="o">%</span> ticker.price_change_percent,
      <span class="s">&quot;high: %0.6f&quot;</span> <span class="o">%</span> ticker.high_price,
      <span class="s">&quot;low: %0.6f&quot;</span> <span class="o">%</span> ticker.low_price
    ].join(<span class="s">&quot; &quot;</span>)
<span class="k">end</span></code></pre>

<pre><code class="language-text">WEIGHT 40
TICKERS 558
ETHBTC bid: 0.025352 ask: 0.025362 change: -2.282 high: 0.026600 low: 0.025004
LTCBTC bid: 0.010711 ask: 0.010717 change: 1.046 high: 0.010872 low: 0.009991
BNBBTC bid: 0.002767 ask: 0.002768 change: -3.726 high: 0.002969 low: 0.002705
NEOBTC bid: 0.001521 ask: 0.001522 change: -2.311 high: 0.001589 low: 0.001484
QTUMETH bid: 0.017040 ask: 0.017126 change: -0.719 high: 0.017617 low: 0.016782</code></pre>

<p><span class="flag purple">NOTE</span>  used_weight is cumulative
Each endpoint has it's own Response object derived from the ServerResponse object and, consequentially, the specific properties that are mapped to the JSON.  For example,
the <a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#check-server-time">time</a> endpoint returns a <code>TimeResponse</code> with one additional property value, the "serverTime", accessible as follows:</p>

<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;binance&quot;</span>

client <span class="o">=</span> <span class="t">Binance</span><span class="t">::</span><span class="t">REST</span>.<span class="k">new</span>

puts client.time.server_time.inspect

<span class="c"># =&gt; 2019-07-03 18:41:45.491000000 UTC</span></code></pre>

<h2><a id="testing" class="anchor" href="#testing">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Testing</h2>

<p>Testing is done primarily with webmock and stubbing server responses.  To make testing
easier, a mini-<a href="https://github.com/vcr/vcr">VCR style record and playback</a> set of helpers
was implemented.</p>

<p>However, only PUBLIC API VCR cassettes are committed to the repo.  To test SIGNED/VERIFIED
API calls, you'll have to setup your private API credentials.</p>

<h2><a id="development" class="anchor" href="#development">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Development</h2>

<p>All API's are TDD and have specs.  If you find a bug or want to contribute, then your
contributions is expected to have specs exercising your code changes.</p>

<p>API calls are captured with so-called VCR cassettes, which is a <a href="https://github.com/mwlang/binance/blob/master/spec/support/vcr.cr">small library</a> built upon Webmock for capturing and playing back a server interaction with one caveat:  signed APIs (those requiring API key) are not checked
into the repository.  As a consequence, you'll have to set up your API key and record your own
cassettes locally to get specs passing.  Signed exchanges are necessarily kept somewhat generic, but read the specs for prerequisites to actions you much take on Binance manually to prepare
to capture your signed cassettes.</p>

<p><span class="flag purple">NOTE</span>  Signed exchanges are saved to ./spec/fixtures/vcr_cassettes/signed and this folder is excluded in the .gitignore file.</p>

<p>To set up your API key for test environment, rename ./spec/test.yml.example to ./spec/test.yml
and replace values in the file with your own API key.  This file is likewise excluded via .gitignore.</p>

<p>From time to time, Binance silently releases changes to their API, adding new and undocumented fields.  For example, the <code></code><code>account</code><code></code> api presently returns a accountType with value "MARGIN",
but this field is not yet documented nor are the ENUM values known at this time.  When noticed,
these fields may be added and parsed without issue.</p>

<h2><a id="contributing" class="anchor" href="#contributing">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributing</h2>

<p>Pull Requests welcomed.  Fully spec'd PR's are likely to get merged!</p>

<ol><li>Fork it (&lt;https://github.com/mwlang/binance/fork>)</li><li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li><li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li><li>Push to the branch (<code>git push origin my-new-feature</code>)</li><li>Create a new Pull Request</li></ol>

<h2><a id="todo" class="anchor" href="#todo">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>TODO</h2>

<p><span class="flag orange">TODO</span>  extend the VCR functionality to obsfucate SIGNED calls to avoid revealing api keys.</p>

<p><span class="flag orange">TODO</span>  build Websocket wrappers</p>

<h2><a id="contributors" class="anchor" href="#contributors">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributors</h2>

<ul><li><a href="https://github.com/mwlang">mwlang</a> - creator and maintainer</li></ul>
</div>
</body>
</html>
